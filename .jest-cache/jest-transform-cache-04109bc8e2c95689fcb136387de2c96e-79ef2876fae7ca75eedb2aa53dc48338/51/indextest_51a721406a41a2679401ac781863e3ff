7013f7c52f8d205ede8b9dbfb7c36138
_getJestObj().mock('../NativeShield', function () {
  return mockShield;
});
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _index = require("../index");
function _getJestObj() {
  var _require = require("@jest/globals"),
    jest = _require.jest;
  _getJestObj = function _getJestObj() {
    return jest;
  };
  return jest;
}
var mockShield = {
  isRooted: jest.fn(),
  addSSLPinning: jest.fn(),
  preventScreenshot: jest.fn(),
  setSecureString: jest.fn(),
  getSecureString: jest.fn(),
  removeSecureString: jest.fn()
};
describe('react-native-shield', function () {
  beforeEach(function () {
    jest.clearAllMocks();
  });
  describe('Device Integrity', function () {
    it('isRooted calls NativeShield.isRooted', function () {
      mockShield.isRooted.mockReturnValue(true);
      expect((0, _index.isRooted)()).toBe(true);
      expect(mockShield.isRooted).toHaveBeenCalledTimes(1);
    });
  });
  describe('SSL Pinning', function () {
    it('addSSLPinning calls NativeShield.addSSLPinning', (0, _asyncToGenerator2.default)(function* () {
      var domain = 'example.com';
      var hashes = ['sha256/123'];
      mockShield.addSSLPinning.mockResolvedValue(undefined);
      yield (0, _index.addSSLPinning)(domain, hashes);
      expect(mockShield.addSSLPinning).toHaveBeenCalledWith(domain, hashes);
    }));
  });
  describe('UI Privacy', function () {
    it('preventScreenshot(true) calls NativeShield.preventScreenshot', (0, _asyncToGenerator2.default)(function* () {
      mockShield.preventScreenshot.mockResolvedValue(undefined);
      yield (0, _index.preventScreenshot)(true);
      expect(mockShield.preventScreenshot).toHaveBeenCalledWith(true);
    }));
    it('preventScreenshot(false) calls NativeShield.preventScreenshot', (0, _asyncToGenerator2.default)(function* () {
      mockShield.preventScreenshot.mockResolvedValue(undefined);
      yield (0, _index.preventScreenshot)(false);
      expect(mockShield.preventScreenshot).toHaveBeenCalledWith(false);
    }));
  });
  describe('Secure Storage', function () {
    it('setSecureString pass correct arguments', (0, _asyncToGenerator2.default)(function* () {
      mockShield.setSecureString.mockResolvedValue(true);
      var result = yield (0, _index.setSecureString)('key', 'value');
      expect(result).toBe(true);
      expect(mockShield.setSecureString).toHaveBeenCalledWith('key', 'value');
    }));
    it('getSecureString returns stored value', (0, _asyncToGenerator2.default)(function* () {
      mockShield.getSecureString.mockResolvedValue('secret');
      var result = yield (0, _index.getSecureString)('key');
      expect(result).toBe('secret');
      expect(mockShield.getSecureString).toHaveBeenCalledWith('key');
    }));
    it('removeSecureString calls native remove', (0, _asyncToGenerator2.default)(function* () {
      mockShield.removeSecureString.mockResolvedValue(true);
      var result = yield (0, _index.removeSecureString)('key');
      expect(result).toBe(true);
      expect(mockShield.removeSecureString).toHaveBeenCalledWith('key');
    }));
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZ2V0SmVzdE9iaiIsIm1vY2siLCJtb2NrU2hpZWxkIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfYXN5bmNUb0dlbmVyYXRvcjIiLCJfaW5kZXgiLCJfcmVxdWlyZSIsImplc3QiLCJpc1Jvb3RlZCIsImZuIiwiYWRkU1NMUGlubmluZyIsInByZXZlbnRTY3JlZW5zaG90Iiwic2V0U2VjdXJlU3RyaW5nIiwiZ2V0U2VjdXJlU3RyaW5nIiwicmVtb3ZlU2VjdXJlU3RyaW5nIiwiZGVzY3JpYmUiLCJiZWZvcmVFYWNoIiwiY2xlYXJBbGxNb2NrcyIsIml0IiwibW9ja1JldHVyblZhbHVlIiwiZXhwZWN0IiwidG9CZSIsInRvSGF2ZUJlZW5DYWxsZWRUaW1lcyIsImRlZmF1bHQiLCJkb21haW4iLCJoYXNoZXMiLCJtb2NrUmVzb2x2ZWRWYWx1ZSIsInVuZGVmaW5lZCIsInRvSGF2ZUJlZW5DYWxsZWRXaXRoIiwicmVzdWx0Il0sInNvdXJjZXMiOlsiaW5kZXgudGVzdC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiXG5pbXBvcnQge1xuICAgIGlzUm9vdGVkLFxuICAgIGFkZFNTTFBpbm5pbmcsXG4gICAgcHJldmVudFNjcmVlbnNob3QsXG4gICAgc2V0U2VjdXJlU3RyaW5nLFxuICAgIGdldFNlY3VyZVN0cmluZyxcbiAgICByZW1vdmVTZWN1cmVTdHJpbmcsXG59IGZyb20gJy4uL2luZGV4JztcblxuLy8gQ3JlYXRlIGEgbW9jayBmb3IgdGhlIE5hdGl2ZSBNb2R1bGVcbmNvbnN0IG1vY2tTaGllbGQgPSB7XG4gICAgaXNSb290ZWQ6IGplc3QuZm4oKSxcbiAgICBhZGRTU0xQaW5uaW5nOiBqZXN0LmZuKCksXG4gICAgcHJldmVudFNjcmVlbnNob3Q6IGplc3QuZm4oKSxcbiAgICBzZXRTZWN1cmVTdHJpbmc6IGplc3QuZm4oKSxcbiAgICBnZXRTZWN1cmVTdHJpbmc6IGplc3QuZm4oKSxcbiAgICByZW1vdmVTZWN1cmVTdHJpbmc6IGplc3QuZm4oKSxcbn07XG5cbi8vIE1vY2sgdGhlIE5hdGl2ZVNoaWVsZCBpbXBvcnRcbmplc3QubW9jaygnLi4vTmF0aXZlU2hpZWxkJywgKCkgPT4gbW9ja1NoaWVsZCk7XG5cbmRlc2NyaWJlKCdyZWFjdC1uYXRpdmUtc2hpZWxkJywgKCkgPT4ge1xuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdEZXZpY2UgSW50ZWdyaXR5JywgKCkgPT4ge1xuICAgICAgICBpdCgnaXNSb290ZWQgY2FsbHMgTmF0aXZlU2hpZWxkLmlzUm9vdGVkJywgKCkgPT4ge1xuICAgICAgICAgICAgbW9ja1NoaWVsZC5pc1Jvb3RlZC5tb2NrUmV0dXJuVmFsdWUodHJ1ZSk7XG4gICAgICAgICAgICBleHBlY3QoaXNSb290ZWQoKSkudG9CZSh0cnVlKTtcbiAgICAgICAgICAgIGV4cGVjdChtb2NrU2hpZWxkLmlzUm9vdGVkKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ1NTTCBQaW5uaW5nJywgKCkgPT4ge1xuICAgICAgICBpdCgnYWRkU1NMUGlubmluZyBjYWxscyBOYXRpdmVTaGllbGQuYWRkU1NMUGlubmluZycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGRvbWFpbiA9ICdleGFtcGxlLmNvbSc7XG4gICAgICAgICAgICBjb25zdCBoYXNoZXMgPSBbJ3NoYTI1Ni8xMjMnXTtcbiAgICAgICAgICAgIG1vY2tTaGllbGQuYWRkU1NMUGlubmluZy5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpO1xuXG4gICAgICAgICAgICBhd2FpdCBhZGRTU0xQaW5uaW5nKGRvbWFpbiwgaGFzaGVzKTtcblxuICAgICAgICAgICAgZXhwZWN0KG1vY2tTaGllbGQuYWRkU1NMUGlubmluZykudG9IYXZlQmVlbkNhbGxlZFdpdGgoZG9tYWluLCBoYXNoZXMpO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdVSSBQcml2YWN5JywgKCkgPT4ge1xuICAgICAgICBpdCgncHJldmVudFNjcmVlbnNob3QodHJ1ZSkgY2FsbHMgTmF0aXZlU2hpZWxkLnByZXZlbnRTY3JlZW5zaG90JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgbW9ja1NoaWVsZC5wcmV2ZW50U2NyZWVuc2hvdC5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpO1xuICAgICAgICAgICAgYXdhaXQgcHJldmVudFNjcmVlbnNob3QodHJ1ZSk7XG4gICAgICAgICAgICBleHBlY3QobW9ja1NoaWVsZC5wcmV2ZW50U2NyZWVuc2hvdCkudG9IYXZlQmVlbkNhbGxlZFdpdGgodHJ1ZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KCdwcmV2ZW50U2NyZWVuc2hvdChmYWxzZSkgY2FsbHMgTmF0aXZlU2hpZWxkLnByZXZlbnRTY3JlZW5zaG90JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgbW9ja1NoaWVsZC5wcmV2ZW50U2NyZWVuc2hvdC5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpO1xuICAgICAgICAgICAgYXdhaXQgcHJldmVudFNjcmVlbnNob3QoZmFsc2UpO1xuICAgICAgICAgICAgZXhwZWN0KG1vY2tTaGllbGQucHJldmVudFNjcmVlbnNob3QpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGZhbHNlKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnU2VjdXJlIFN0b3JhZ2UnLCAoKSA9PiB7XG4gICAgICAgIGl0KCdzZXRTZWN1cmVTdHJpbmcgcGFzcyBjb3JyZWN0IGFyZ3VtZW50cycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIG1vY2tTaGllbGQuc2V0U2VjdXJlU3RyaW5nLm1vY2tSZXNvbHZlZFZhbHVlKHRydWUpO1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2V0U2VjdXJlU3RyaW5nKCdrZXknLCAndmFsdWUnKTtcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUodHJ1ZSk7XG4gICAgICAgICAgICBleHBlY3QobW9ja1NoaWVsZC5zZXRTZWN1cmVTdHJpbmcpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdrZXknLCAndmFsdWUnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoJ2dldFNlY3VyZVN0cmluZyByZXR1cm5zIHN0b3JlZCB2YWx1ZScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIG1vY2tTaGllbGQuZ2V0U2VjdXJlU3RyaW5nLm1vY2tSZXNvbHZlZFZhbHVlKCdzZWNyZXQnKTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdldFNlY3VyZVN0cmluZygna2V5Jyk7XG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlKCdzZWNyZXQnKTtcbiAgICAgICAgICAgIGV4cGVjdChtb2NrU2hpZWxkLmdldFNlY3VyZVN0cmluZykudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ2tleScpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdCgncmVtb3ZlU2VjdXJlU3RyaW5nIGNhbGxzIG5hdGl2ZSByZW1vdmUnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBtb2NrU2hpZWxkLnJlbW92ZVNlY3VyZVN0cmluZy5tb2NrUmVzb2x2ZWRWYWx1ZSh0cnVlKTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlbW92ZVNlY3VyZVN0cmluZygna2V5Jyk7XG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlKHRydWUpO1xuICAgICAgICAgICAgZXhwZWN0KG1vY2tTaGllbGQucmVtb3ZlU2VjdXJlU3RyaW5nKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgna2V5Jyk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufSk7XG4iXSwibWFwcGluZ3MiOiJBQXFCQUEsV0FBQSxHQUFLQyxJQUFJLENBQUMsaUJBQWlCLEVBQUU7RUFBQSxPQUFNQyxVQUFV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