9d1a7a9ec4e873e00eebfcb6c674cd04
_getJestObj().mock('../NativeShield', function () {
  return {
    __esModule: true,
    default: {
      isRooted: jest.fn(),
      addSSLPinning: jest.fn(),
      preventScreenshot: jest.fn(),
      setSecureString: jest.fn(),
      getSecureString: jest.fn(),
      removeSecureString: jest.fn()
    }
  };
});
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _index = require("../index");
var _NativeShield = _interopRequireDefault(require("../NativeShield"));
function _getJestObj() {
  var _require = require("@jest/globals"),
    jest = _require.jest;
  _getJestObj = function _getJestObj() {
    return jest;
  };
  return jest;
}
describe('react-native-shield', function () {
  beforeEach(function () {
    jest.clearAllMocks();
  });
  describe('Device Integrity', function () {
    it('isRooted calls NativeShield.isRooted', function () {
      _NativeShield.default.isRooted.mockReturnValue(true);
      expect((0, _index.isRooted)()).toBe(true);
      expect(_NativeShield.default.isRooted).toHaveBeenCalledTimes(1);
    });
  });
  describe('SSL Pinning', function () {
    it('addSSLPinning calls NativeShield.addSSLPinning', (0, _asyncToGenerator2.default)(function* () {
      var domain = 'example.com';
      var hashes = ['sha256/123'];
      _NativeShield.default.addSSLPinning.mockResolvedValue(undefined);
      yield (0, _index.addSSLPinning)(domain, hashes);
      expect(_NativeShield.default.addSSLPinning).toHaveBeenCalledWith(domain, hashes);
    }));
  });
  describe('UI Privacy', function () {
    it('preventScreenshot(true) calls NativeShield.preventScreenshot', (0, _asyncToGenerator2.default)(function* () {
      _NativeShield.default.preventScreenshot.mockResolvedValue(undefined);
      yield (0, _index.preventScreenshot)(true);
      expect(_NativeShield.default.preventScreenshot).toHaveBeenCalledWith(true);
    }));
    it('preventScreenshot(false) calls NativeShield.preventScreenshot', (0, _asyncToGenerator2.default)(function* () {
      _NativeShield.default.preventScreenshot.mockResolvedValue(undefined);
      yield (0, _index.preventScreenshot)(false);
      expect(_NativeShield.default.preventScreenshot).toHaveBeenCalledWith(false);
    }));
  });
  describe('Secure Storage', function () {
    it('setSecureString pass correct arguments', (0, _asyncToGenerator2.default)(function* () {
      _NativeShield.default.setSecureString.mockResolvedValue(true);
      var result = yield (0, _index.setSecureString)('key', 'value');
      expect(result).toBe(true);
      expect(_NativeShield.default.setSecureString).toHaveBeenCalledWith('key', 'value');
    }));
    it('getSecureString returns stored value', (0, _asyncToGenerator2.default)(function* () {
      _NativeShield.default.getSecureString.mockResolvedValue('secret');
      var result = yield (0, _index.getSecureString)('key');
      expect(result).toBe('secret');
      expect(_NativeShield.default.getSecureString).toHaveBeenCalledWith('key');
    }));
    it('removeSecureString calls native remove', (0, _asyncToGenerator2.default)(function* () {
      _NativeShield.default.removeSecureString.mockResolvedValue(true);
      var result = yield (0, _index.removeSecureString)('key');
      expect(result).toBe(true);
      expect(_NativeShield.default.removeSecureString).toHaveBeenCalledWith('key');
    }));
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZ2V0SmVzdE9iaiIsIm1vY2siLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsImlzUm9vdGVkIiwiamVzdCIsImZuIiwiYWRkU1NMUGlubmluZyIsInByZXZlbnRTY3JlZW5zaG90Iiwic2V0U2VjdXJlU3RyaW5nIiwiZ2V0U2VjdXJlU3RyaW5nIiwicmVtb3ZlU2VjdXJlU3RyaW5nIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfYXN5bmNUb0dlbmVyYXRvcjIiLCJfaW5kZXgiLCJfTmF0aXZlU2hpZWxkIiwiX3JlcXVpcmUiLCJkZXNjcmliZSIsImJlZm9yZUVhY2giLCJjbGVhckFsbE1vY2tzIiwiaXQiLCJOYXRpdmVTaGllbGQiLCJtb2NrUmV0dXJuVmFsdWUiLCJleHBlY3QiLCJ0b0JlIiwidG9IYXZlQmVlbkNhbGxlZFRpbWVzIiwiZG9tYWluIiwiaGFzaGVzIiwibW9ja1Jlc29sdmVkVmFsdWUiLCJ1bmRlZmluZWQiLCJ0b0hhdmVCZWVuQ2FsbGVkV2l0aCIsInJlc3VsdCJdLCJzb3VyY2VzIjpbImluZGV4LnRlc3QudHN4Il0sInNvdXJjZXNDb250ZW50IjpbIlxuaW1wb3J0IHtcbiAgICBpc1Jvb3RlZCxcbiAgICBhZGRTU0xQaW5uaW5nLFxuICAgIHByZXZlbnRTY3JlZW5zaG90LFxuICAgIHNldFNlY3VyZVN0cmluZyxcbiAgICBnZXRTZWN1cmVTdHJpbmcsXG4gICAgcmVtb3ZlU2VjdXJlU3RyaW5nLFxufSBmcm9tICcuLi9pbmRleCc7XG5pbXBvcnQgTmF0aXZlU2hpZWxkIGZyb20gJy4uL05hdGl2ZVNoaWVsZCc7XG5cbi8vIFByZXBhcmUgdGhlIG1vY2tcbmplc3QubW9jaygnLi4vTmF0aXZlU2hpZWxkJywgKCkgPT4ge1xuICAgIHJldHVybiB7XG4gICAgICAgIF9fZXNNb2R1bGU6IHRydWUsXG4gICAgICAgIGRlZmF1bHQ6IHtcbiAgICAgICAgICAgIGlzUm9vdGVkOiBqZXN0LmZuKCksXG4gICAgICAgICAgICBhZGRTU0xQaW5uaW5nOiBqZXN0LmZuKCksXG4gICAgICAgICAgICBwcmV2ZW50U2NyZWVuc2hvdDogamVzdC5mbigpLFxuICAgICAgICAgICAgc2V0U2VjdXJlU3RyaW5nOiBqZXN0LmZuKCksXG4gICAgICAgICAgICBnZXRTZWN1cmVTdHJpbmc6IGplc3QuZm4oKSxcbiAgICAgICAgICAgIHJlbW92ZVNlY3VyZVN0cmluZzogamVzdC5mbigpLFxuICAgICAgICB9LFxuICAgIH07XG59KTtcblxuZGVzY3JpYmUoJ3JlYWN0LW5hdGl2ZS1zaGllbGQnLCAoKSA9PiB7XG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ0RldmljZSBJbnRlZ3JpdHknLCAoKSA9PiB7XG4gICAgICAgIGl0KCdpc1Jvb3RlZCBjYWxscyBOYXRpdmVTaGllbGQuaXNSb290ZWQnLCAoKSA9PiB7XG4gICAgICAgICAgICAoTmF0aXZlU2hpZWxkLmlzUm9vdGVkIGFzIGplc3QuTW9jaykubW9ja1JldHVyblZhbHVlKHRydWUpO1xuICAgICAgICAgICAgZXhwZWN0KGlzUm9vdGVkKCkpLnRvQmUodHJ1ZSk7XG4gICAgICAgICAgICBleHBlY3QoTmF0aXZlU2hpZWxkLmlzUm9vdGVkKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ1NTTCBQaW5uaW5nJywgKCkgPT4ge1xuICAgICAgICBpdCgnYWRkU1NMUGlubmluZyBjYWxscyBOYXRpdmVTaGllbGQuYWRkU1NMUGlubmluZycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGRvbWFpbiA9ICdleGFtcGxlLmNvbSc7XG4gICAgICAgICAgICBjb25zdCBoYXNoZXMgPSBbJ3NoYTI1Ni8xMjMnXTtcbiAgICAgICAgICAgIChOYXRpdmVTaGllbGQuYWRkU1NMUGlubmluZyBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCk7XG5cbiAgICAgICAgICAgIGF3YWl0IGFkZFNTTFBpbm5pbmcoZG9tYWluLCBoYXNoZXMpO1xuXG4gICAgICAgICAgICBleHBlY3QoTmF0aXZlU2hpZWxkLmFkZFNTTFBpbm5pbmcpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGRvbWFpbiwgaGFzaGVzKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnVUkgUHJpdmFjeScsICgpID0+IHtcbiAgICAgICAgaXQoJ3ByZXZlbnRTY3JlZW5zaG90KHRydWUpIGNhbGxzIE5hdGl2ZVNoaWVsZC5wcmV2ZW50U2NyZWVuc2hvdCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIChOYXRpdmVTaGllbGQucHJldmVudFNjcmVlbnNob3QgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpO1xuICAgICAgICAgICAgYXdhaXQgcHJldmVudFNjcmVlbnNob3QodHJ1ZSk7XG4gICAgICAgICAgICBleHBlY3QoTmF0aXZlU2hpZWxkLnByZXZlbnRTY3JlZW5zaG90KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh0cnVlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoJ3ByZXZlbnRTY3JlZW5zaG90KGZhbHNlKSBjYWxscyBOYXRpdmVTaGllbGQucHJldmVudFNjcmVlbnNob3QnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAoTmF0aXZlU2hpZWxkLnByZXZlbnRTY3JlZW5zaG90IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUodW5kZWZpbmVkKTtcbiAgICAgICAgICAgIGF3YWl0IHByZXZlbnRTY3JlZW5zaG90KGZhbHNlKTtcbiAgICAgICAgICAgIGV4cGVjdChOYXRpdmVTaGllbGQucHJldmVudFNjcmVlbnNob3QpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGZhbHNlKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnU2VjdXJlIFN0b3JhZ2UnLCAoKSA9PiB7XG4gICAgICAgIGl0KCdzZXRTZWN1cmVTdHJpbmcgcGFzcyBjb3JyZWN0IGFyZ3VtZW50cycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIChOYXRpdmVTaGllbGQuc2V0U2VjdXJlU3RyaW5nIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUodHJ1ZSk7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXRTZWN1cmVTdHJpbmcoJ2tleScsICd2YWx1ZScpO1xuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZSh0cnVlKTtcbiAgICAgICAgICAgIGV4cGVjdChOYXRpdmVTaGllbGQuc2V0U2VjdXJlU3RyaW5nKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgna2V5JywgJ3ZhbHVlJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KCdnZXRTZWN1cmVTdHJpbmcgcmV0dXJucyBzdG9yZWQgdmFsdWUnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAoTmF0aXZlU2hpZWxkLmdldFNlY3VyZVN0cmluZyBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKCdzZWNyZXQnKTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdldFNlY3VyZVN0cmluZygna2V5Jyk7XG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlKCdzZWNyZXQnKTtcbiAgICAgICAgICAgIGV4cGVjdChOYXRpdmVTaGllbGQuZ2V0U2VjdXJlU3RyaW5nKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgna2V5Jyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KCdyZW1vdmVTZWN1cmVTdHJpbmcgY2FsbHMgbmF0aXZlIHJlbW92ZScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIChOYXRpdmVTaGllbGQucmVtb3ZlU2VjdXJlU3RyaW5nIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUodHJ1ZSk7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZW1vdmVTZWN1cmVTdHJpbmcoJ2tleScpO1xuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZSh0cnVlKTtcbiAgICAgICAgICAgIGV4cGVjdChOYXRpdmVTaGllbGQucmVtb3ZlU2VjdXJlU3RyaW5nKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgna2V5Jyk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufSk7XG4iXSwibWFwcGluZ3MiOiJBQVlBQSxXQUFBLEdBQUtDLElBQUksQ0FBQyxpQkFBaUIsRUFBRSxZQUFNO0VBQy9CLE9BQU87SUFDSEMsVUFBVSxFQUFFLElBQUk7SUFDaEJDLE9BQU8sRUFBRTtNQUNMQyxRQUFRLEVBQUVDLElBQUksQ0FBQ0MsRUFBRSxDQUFDLENBQUM7TUFDbkJDLGFBQWEsRUFBRUYsSUFBSSxDQUFDQyxFQUFFLENBQUMsQ0FBQztNQUN4QkUsaUJBQWlCLEVBQUVILElBQUksQ0FBQ0MsRUFBRSxDQUFDLENBQUM7TUFDNUJHLGVBQWUsRUFBRUosSUFBSSxDQUFDQyxFQUFFLENBQUMsQ0FBQztNQUMxQkksZUFBZSxFQUFFTCxJQUFJLENBQUNDLEVBQUUsQ0FBQyxDQUFDO01BQzFCSyxrQkFBa0IsRUFBRU4sSUFBSSxDQUFDQyxFQUFFLENBQUM7SUFDaEM7RUFDSixDQUFDO0FBQ0wsQ0FBQyxDQUFDO0FBQUMsSUFBQU0sc0JBQUEsR0FBQUMsT0FBQTtBQUFBLElBQUFDLGtCQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUF2QkgsSUFBQUUsTUFBQSxHQUFBRixPQUFBO0FBUUEsSUFBQUcsYUFBQSxHQUFBSixzQkFBQSxDQUFBQyxPQUFBO0FBQTJDLFNBQUFiLFlBQUE7RUFBQSxJQUFBaUIsUUFBQSxHQUFBSixPQUFBO0lBQUFSLElBQUEsR0FBQVksUUFBQSxDQUFBWixJQUFBO0VBQUFMLFdBQUEsWUFBQUEsWUFBQTtJQUFBLE9BQUFLLElBQUE7RUFBQTtFQUFBLE9BQUFBLElBQUE7QUFBQTtBQWlCM0NhLFFBQVEsQ0FBQyxxQkFBcUIsRUFBRSxZQUFNO0VBQ2xD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